# 주차 관리 시스템 통합 명세서

## 1. 시스템 개요

### 1.1 데이터 구조 관계
- **공간(호실)**: households - 물리적 공간 단위
- **조직(입주세대)**: household_instances - 호실에 배정된 세대 인스턴스
- **개인(입주민)**: residents - 세대에 속한 개인(거주민, 상업인)

### 1.2 핵심 개념
1. **공간 (호실)**: 건물 내 실제 물리적 공간을 나타내는 최상위 단위. 시간의 흐름에 따라 여러 세대가 입주하고 퇴거하는 컨테이너 역할
2. **조직 (입주세대)**: 특정 시점에 특정 호실에 거주하는 세대. 각 세대는 독립적인 인스턴스로서 고유한 설정과 구성원 보유
3. **개인 (입주민)**: 세대를 구성하는 실제 개인. 세대 간 이동이 가능하며 모든 이동 이력은 영구적으로 기록

## 2. API 명세

### 2.1 호실(세대) 관련 API
| No | Method | Endpoint | 설명 |
|----|--------|----------|------|
| 1  | POST   | /households | 세대 생성 |
| 2  | GET    | /households | 세대 목록 조회 |
| 3  | GET    | /households/{id} | 세대 상세 조회 |
| 4  | PUT    | /households/{id} | 세대 정보 수정 |
| 5  | DELETE | /households/{id} | 세대 삭제 |

### 2.2 세대 인스턴스 관련 API
| No | Method | Endpoint | 설명 |
|----|--------|----------|------|
| 6  | POST   | /households/{id}/instances | 세대 인스턴스 생성 |
| 7  | GET    | /households/{id}/instances | 세대별 인스턴스 목록 |
| 8  | GET    | /households/instances | 세대 인스턴스 검색 |
| 9  | GET    | /households/instances/{instance_id} | 세대 인스턴스 상세 조회 |
| 10 | PUT    | /households/instances/{instance_id} | 세대 인스턴스 수정 |
| 11 | DELETE | /households/instances/{instance_id} | 세대 인스턴스 삭제 |
| 12 | GET    | /households/instances/{instance_id}/config/visit | 세대 방문 설정 조회 |
| 13 | PUT    | /households/instances/{instance_id}/config/visit | 세대 방문 설정 수정 |
| 14 | PUT    | /households/instances/{instance_id}/config/service | 세대 서비스 설정 수정 |

### 2.3 거주자 관련 API
| No | Method | Endpoint | 설명 |
|----|--------|----------|------|
| 15 | GET    | /residents | 거주자 목록 조회 |
| 16 | GET    | /residents/{id} | 거주자 상세 조회 |
| 17 | PATCH  | /residents/{id} | 거주자 수정 |
| 18 | DELETE | /residents/{id} | 거주자 삭제 |
| 19 | GET    | /residents/{id}/history | 거주자 이동 이력 조회 |
| 20 | POST   | /residents/move | 거주자 세대 이동 |

### 2.4 거주자-세대 관계 API
| No | Method | Endpoint | 설명 |
|----|--------|----------|------|
| 21 | POST   | /residents/households | 거주자-세대 인스턴스 관계 생성 |
| 22 | PATCH  | /residents/households/{id} | 거주자-세대 인스턴스 관계 수정 |
| 23 | DELETE | /residents/households/{id} | 거주자-세대 인스턴스 관계 삭제 |

## 3. 통합 뷰 (신규 추가)

### 3.1 개요
- **목적**: 공간-조직-개인을 잇는 개념 추상화 페이지
- **구성**: 
  - 좌측: 수직 플로우차트 (공간 → 조직 → 개인)
  - 우측: 마우스오버 시 해당 항목의 상세 설명 및 관련 메뉴
- **디자인**: 흑백 신문지 스타일, 전문성과 정밀성 강조

### 3.2 우측 패널 구조
각 영역 마우스오버 시 표시되는 페이지 구조 (중첩 박스):

#### 호실 관리
```
┌─ 호실 목록 ─────────────────────────┐
│  기능: 검색, 필터링, 삭제             │
│  ┌─ 호실 상세 ───────────────────┐ │
│  │  기능: 조회, 수정, 삭제,        │ │
│  │       세대 배정                │ │
│  └──────────────────────────────┘ │
└────────────────────────────────────┘

┌─ 호실 등록 ─────────────────────────┐
│  기능: 신규 생성, 유효성 검증         │
└────────────────────────────────────┘
```

#### 입주세대 관리
```
┌─ 세대 목록 ─────────────────────────┐
│  기능: 검색, 필터링, 삭제             │
│  ┌─ 세대 상세 ───────────────────┐ │
│  │  기능: 조회, 수정, 삭제,        │ │
│  │       구성원 관리, 서비스 설정,   │ │
│  │       방문 설정                │ │
│  └──────────────────────────────┘ │
└────────────────────────────────────┘

┌─ 세대 등록 ─────────────────────────┐
│  기능: 신규 배정, 호실 선택           │
└────────────────────────────────────┘

┌─ 세대 이동 ─────────────────────────┐
│  기능: 호실 간 이동, 이력 기록        │
└────────────────────────────────────┘
```

#### 입주민 관리
```
┌─ 입주민 목록 ────────────────────────┐
│  기능: 검색, 필터링, 삭제              │
│  ┌─ 입주민 상세 ──────────────────┐ │
│  │  기능: 조회, 수정, 삭제,         │ │
│  │       세대 변경, 이동 이력       │ │
│  └───────────────────────────────┘ │
└─────────────────────────────────────┘

┌─ 입주민 등록 ────────────────────────┐
│  기능: 신규 등록, 세대 배정            │
└─────────────────────────────────────┘

┌─ 입주민 이동 ────────────────────────┐
│  기능: 세대 간 이동, 이력 기록         │
└─────────────────────────────────────┘

┌─ 이동 이력 ──────────────────────────┐
│  기능: 이력 조회, 기간 필터            │
└─────────────────────────────────────┘
```

## 4. 메뉴 및 페이지 구조

### 4.1 전체 메뉴 구조
```
주차 > 세대관리 >
├── 통합뷰                    # /parking/household-management/overview
├── 호실관리                  # /parking/household-management/household
├── 입주세대관리              # /parking/household-management/household-instance  
└── 입주민관리                # /parking/household-management/resident
```

### 4.2 호실 관리

#### 주차 > 세대관리 > 호실관리 | 목록 P[표]
- **기능**: 검색, 삭제
- **사용 API**: 
  - API 2: 세대 목록 조회
  - API 5: 세대 삭제

#### 주차 > 세대관리 > 호실관리 > 상세 P
- **기능**: 조회, 수정, 삭제, 세대 목록[카드], 세대 배정/해제
- **사용 API**: 
  - API 3: 세대 상세 조회
  - API 4: 세대 정보 수정
  - API 7: 세대별 인스턴스 목록

#### 주차 > 세대관리 > 호실관리 > 등록 P
- **기능**: 신규 등록
- **사용 API**: 
  - API 1: 세대 생성

### 4.3 입주세대 관리

#### 주차 > 세대관리 > 입주세대관리 | 목록 P[표]
- **기능**: 검색, 삭제
- **사용 API**: 
  - API 8: 세대 인스턴스 검색
  - API 11: 세대 인스턴스 삭제

#### 주차 > 세대관리 > 입주세대관리 > 상세 P
- **기능**: 조회, 수정, 삭제, 구성원 목록[카드], 구성원 추가/제외, 호실 변경, 주차 서비스 설정, 방문 설정
- **사용 API**: 
  - API 9: 세대 인스턴스 상세 조회
  - API 10: 세대 인스턴스 수정
  - API 15: 거주자 목록 조회
  - API 21: 거주자-세대 관계 생성
  - API 23: 거주자-세대 관계 삭제
  - API 12: 세대 방문 설정 조회
  - API 13: 세대 방문 설정 수정
  - API 14: 세대 서비스 설정 수정

#### 주차 > 세대관리 > 입주세대관리 > 등록 P
- **기능**: 신규 등록
- **사용 API**: 
  - API 6: 세대 인스턴스 생성

#### 주차 > 세대관리 > 입주세대관리 > 이동 P
- **기능**: 세대의 호실 간 이동
- **사용 API**: 
  - API 10: 세대 인스턴스 수정 (호실 변경)

### 4.4 입주민 관리

#### 주차 > 세대관리 > 입주민관리 | 목록 P[표]
- **기능**: 검색, 삭제
- **사용 API**: 
  - API 15: 거주자 목록 조회
  - API 18: 거주자 삭제

#### 주차 > 세대관리 > 입주민관리 > 상세 P
- **기능**: 조회, 수정, 삭제, 세대 변경, 이동 이력[표]
- **사용 API**: 
  - API 16: 거주자 상세 조회
  - API 17: 거주자 수정
  - API 19: 거주자 이동 이력 조회
  - API 22: 거주자-세대 관계 수정

#### 주차 > 세대관리 > 입주민관리 > 등록 P
- **기능**: 신규 등록
- **사용 API**: 
  - API 21: 거주자-세대 관계 생성

#### 주차 > 세대관리 > 입주민관리 > 이동 P
- **기능**: 입주민의 세대 간 이동
- **사용 API**: 
  - API 20: 거주자 세대 이동

#### 주차 > 세대관리 > 입주민관리 > 이동이력 P[표]
- **기능**: 입주민별 이력 조회
- **사용 API**: 
  - API 19: 거주자 이동 이력 조회

## 5. 페이지별 주요 기능 요약

### 5.1 목록 페이지 공통 기능
- 테이블 형태의 데이터 표시
- 검색 및 필터링 기능
- 행 내 삭제 버튼
- 상세/등록 페이지로 이동

### 5.2 상세 페이지 공통 기능
- 정보 조회 및 수정
- 하위 항목 카드 형태 표시
- 관련 항목 추가/제외
- 삭제 기능

### 5.3 등록/이동 페이지 공통 기능
- 폼 입력
- 유효성 검증
- 등록/이동 처리

## 6. 구현 가이드라인

### 6.1 디자인 원칙
- 전문성과 정밀성을 강조하는 흑백 신문지 스타일
- 계층 구조를 명확히 표현하는 중첩 박스 레이아웃
- 직관적인 페이지 간 포함관계 시각화

### 6.2 사용자 경험
- 통합 뷰를 통한 전체 시스템 구조 이해
- 페이지 간 명확한 네비게이션 경로 제공
- 각 페이지별 사용 가능한 기능 명시

### 6.3 용어 통일
| 개발 용어 | 사용자 노출 용어 |
|-----------|----------------|
| household | 호실 |
| household_instance | 입주세대 |
| resident | 입주민 |